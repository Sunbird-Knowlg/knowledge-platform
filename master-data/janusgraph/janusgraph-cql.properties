gremlin.graph=org.janusgraph.core.JanusGraphFactory
storage.backend=cql
storage.hostname=sunbird-yugabyte
storage.cql.keyspace=janusgraph

# CRITICAL: Transaction log configuration for CDC
# Keep enabled for CDC, but ensure writes are applied to backend
tx.log.tx.enabled=true
tx.log.tx.instance-id=janusgraph-instance-1

# CRITICAL FIX: Transaction log backend configuration
# This is what was MISSING - without this, logged transactions have no storage!
# The log identifier MUST match what's used in code: logIdentifier("learning_graph_events")
log.learning_graph_events.backend=default
log.learning_graph_events.key-consistent=true
log.learning_graph_events.read-interval=500

# Disable database cache to ensure read-after-write consistency
# This prevents stale cached data from being returned after commits
cache.db-cache=false
cache.db-cache-time=0
cache.db-cache-size=0

# Ensure transaction cache is also properly configured
cache.tx-cache-size=20000

# Force immediate writes to backend storage with strongest consistency
# ALL ensures writes are visible to all replicas before commit returns
storage.cql.write-consistency-level=ALL
storage.cql.read-consistency-level=ALL

# Ensure batch mutations are flushed immediately
storage.batch-loading=false

# Force transaction log to flush to storage immediately
storage.cql.local-datacenter=datacenter1
storage.cql.replication-factor=1
